<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Sool Primary - Fast School Management</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    body{font-family:system-ui,-apple-system,sans-serif;background:linear-gradient(135deg,#f0f9ff,#e0f2fe);min-height:100vh;padding:16px;color:#1e293b;line-height:1.4}
    .container{max-width:520px;margin:0 auto}
    .card{background:white;border-radius:16px;box-shadow:0 4px 12px rgba(0,0,0,0.08);padding:24px;margin-bottom:20px;overflow:hidden}
    .header{text-align:center;margin-bottom:24px}
    .header h1{color:#0c4a6e;font-size:clamp(20px,5vw,28px);font-weight:700;margin-bottom:8px}
    .user-tag{font-size:14px;color:#64748b}
    .tabs{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap;overflow-x:auto;-webkit-overflow-scrolling:touch}
    .tab-btn{padding:12px 16px;background:#f1f5f9;border:none;border-radius:12px;font-weight:600;font-size:15px;cursor:pointer;transition:all 0.2s;flex:1;min-width:100px;text-align:center;white-space:nowrap}
    .tab-btn.active{background:#3b82f6;color:white}
    .tab-btn:active{transform:scale(0.98)}
    .form-group{margin-bottom:20px}
    label{display:block;margin-bottom:8px;font-weight:600;font-size:15px}
    input,select{width:100%;padding:14px;border:1px solid #cbd5e1;border-radius:12px;font-size:16px;background:white;transition:border-color 0.2s}
    input:focus,select:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px rgba(59,130,246,0.2)}
    .date-field{display:flex;gap:10px}
    .btn-today{background:#10b981;color:white;border:none;padding:14px 16px;border-radius:12px;font-weight:600;cursor:pointer;font-size:15px}
    .btn-today:active{background:#059669}
    .session-buttons,.status-buttons{display:flex;gap:10px;flex-wrap:wrap}
    .session-btn,.status-btn{flex:1;padding:14px;border:none;border-radius:12px;font-weight:600;font-size:15px;cursor:pointer;transition:all 0.2s;min-width:80px}
    .session-btn.active,.status-btn.active{transform:scale(0.97);box-shadow:0 2px 6px rgba(0,0,0,0.15)}
    .session-btn:not(.active){background:#f1f5f9;color:#475569}
    .session-btn.active{background:#3b82f6;color:white}
    .status-btn.present{background:#dcfce7;color:#166534}
    .status-btn.absent{background:#fee2e2;color:#b91c1c}
    .status-btn.late{background:#fef3c7;color:#92400e}
    .status-btn.sick{background:#ede9fe;color:#5b21b6}
    .status-btn.active{background:#3b82f6;color:white!important}
    .btn-save,.btn-all-present{background:#0ea5e9;color:white;border:none;width:100%;padding:18px;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;margin-bottom:15px;transition:background 0.2s}
    .btn-all-present{background:#10b981!important;padding:16px;font-size:16px}
    .btn-save:active,.btn-all-present:active{background:#0284c7}
    .btn-logout,.btn-danger{background:#ef4444;color:white;border:none;width:100%;padding:18px;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;margin-top:10px}
    .btn-danger:active,.btn-logout:active{background:#dc2626}
    .btn-success{background:#10b981;color:white;border:none;width:100%;padding:16px;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;margin-bottom:10px}
    .btn-success:active{background:#059669}
    .message{padding:14px;border-radius:12px;text-align:center;margin-top:16px;font-weight:600;transition:opacity 0.3s}
    .success{background:#dcfce7;color:#166534}
    .error{background:#fee2e2;color:#b91c1c}
    #loginContainer{display:block}
    #appContainer{display:none}
    .tab-content{display:none}
    .tab-content.active{display:block}
    .students-list,.users-list{max-height:400px;overflow-y:auto;margin-top:20px}
    .student-row,.user-row{display:flex;justify-content:space-between;align-items:center;padding:12px;background:#f8fafc;border-radius:8px;margin-bottom:8px}
    .student-name,.user-name{font-weight:600}
    .student-status,.user-role{padding:6px 12px;border-radius:20px;font-size:12px;font-weight:600;min-width:60px;text-align:center;cursor:pointer}
    .status-present{background:#dcfce7;color:#166534}
    .status-absent{background:#fee2e2;color:#b91c1c}
    .status-late{background:#fef3c7;color:#92400e}
    .status-sick{background:#ede9fe;color:#5b21b6}
    .role-admin{background:#3b82f6;color:white}
    .role-teacher{background:#10b981;color:white}
  </style>
</head>
<body>
  <div class="container" id="loginContainer">
    <div class="card">
      <div class="header">
        <h1>üè´ Sool Primary</h1>
        <p style="color:#64748b;">Staff Login</p>
      </div>
      <form id="loginForm">
        <div class="form-group">
          <label>Username</label>
          <input type="text" id="username" autocomplete="off" placeholder="A, M, S, I, Z, AHMED" required/>
        </div>
        <div class="form-group">
          <label>Password</label>
          <input type="password" id="password" placeholder="Try A/3245" required/>
        </div>
        <button type="submit" class="btn-save">üöÄ Sign In</button>
        <div id="loginError" class="message error" style="display:none;"></div>
      </form>
    </div>
  </div>

  <div class="container" id="appContainer">
    <div class="card">
      <div class="header">
        <h1>üìö Sool Primary</h1>
        <div class="user-tag" id="userDisplay"></div>
      </div>
      <div class="tabs" id="mainTabs"></div>
      <div id="globalMessage" class="message" style="display:none;"></div>

      <!-- ATTENDANCE TAB -->
      <div id="attendanceTab" class="tab-content">
        <div class="form-group">
          <label>Date</label>
          <div class="date-field">
            <input type="date" id="attDate"/>
            <button type="button" class="btn-today" onclick="setToday()">Today</button>
          </div>
        </div>
        <div class="form-group">
          <label>Session</label>
          <div class="session-buttons">
            <button type="button" class="session-btn active" data-session="morning">Morning</button>
            <button type="button" class="session-btn" data-session="after_break">After Break</button>
          </div>
        </div>
        <div class="form-group">
          <label>Class</label>
          <select id="attClass" onchange="loadTodayAttendance()">
            <option value="">Select Class</option>
            <option value="1aad">Grade 1</option><option value="2aad">Grade 2</option>
            <option value="3aad">Grade 3</option><option value="4aad">Grade 4</option>
            <option value="5aad">Grade 5</option><option value="6aad">Grade 6</option>
            <option value="7aad">Grade 7</option><option value="8aad">Grade 8</option>
          </select>
        </div>
        <button type="button" class="btn-all-present" onclick="markAllPresent()">üìã Mark All Present</button>
        <div id="singleEntry">
          <div class="form-group">
            <label>Roll #</label>
            <input type="number" id="attRoll" min="1" placeholder="Enter roll"/>
          </div>
          <div class="form-group">
            <label>Name</label>
            <input type="text" id="attName" placeholder="Auto-filled"/>
          </div>
          <div class="form-group">
            <label>Status</label>
            <div class="status-buttons">
              <button type="button" class="status-btn present active" data-status="present">Present</button>
              <button type="button" class="status-btn absent" data-status="absent">Absent</button>
              <button type="button" class="status-btn late" data-status="late">Late</button>
              <button type="button" class="status-btn sick" data-status="sick">Sick</button>
            </div>
          </div>
          <button type="button" class="btn-save" onclick="saveSingleAttendance()">Save Single</button>
        </div>
        <div id="todayAttendance" class="students-list" style="display:none;"></div>
        <button type="button" class="btn-logout" onclick="logout()">Logout</button>
      </div>

      <!-- REGISTER TAB -->
      <div id="registerTab" class="tab-content">
        <h3 style="margin-bottom:20px;font-size:20px;">üìù Register Student</h3>
        <div class="form-group"><label>Name *</label><input type="text" id="regName"/></div>
        <div class="form-group"><label>Mother *</label><input type="text" id="regMother"/></div>
        <div class="form-group"><label>DOB *</label><input type="date" id="regDOB"/></div>
        <div class
