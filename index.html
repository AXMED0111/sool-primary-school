<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sool Primary School Management</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px;color:#333}
    .container{max-width:500px;margin:0 auto}
    .card{background:white;border-radius:20px;padding:30px;box-shadow:0 20px 40px rgba(0,0,0,0.1);margin-bottom:20px}
    h1{text-align:center;color:#1e293b;font-size:28px;margin-bottom:10px;font-weight:700}
    h2,h3{margin:25px 0 15px 0;color:#1e293b;font-weight:600}
    label{display:block;margin:12px 0 6px;font-weight:600;color:#374151}
    input,select{width:100%;padding:15px;border:2px solid #e5e7eb;border-radius:12px;font-size:16px;background:#f9fafb;transition:all 0.3s}
    input:focus,select:focus{border-color:#3b82f6;outline:none;background:white;box-shadow:0 0 0 3px rgba(59,130,246,0.1)}
    .btn{width:100%;padding:16px;margin:10px 0;border:none;border-radius:12px;font-size:16px;font-weight:700;cursor:pointer;transition:all 0.2s}
    .btn-primary{background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:white}
    .btn-success{background:linear-gradient(135deg,#10b981,#059669);color:white}
    .btn-danger{background:linear-gradient(135deg,#ef4444,#dc2626);color:white}
    .btn:active{transform:translateY(1px)}
    .tabs{display:flex;gap:10px;margin:25px 0;flex-wrap:wrap}
    .tab-btn{flex:1;padding:14px;border:none;border-radius:12px;background:#f1f5f9;color:#6b7280;font-weight:600;cursor:pointer;transition:all 0.3s;flex-basis:90px}
    .tab-btn.active{background:#3b82f6;color:white;transform:translateY(-2px)}
    .tab-content{display:none}
    .tab-content.active{display:block;animation:slideIn 0.3s ease}
    @keyframes slideIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    .message{padding:15px;border-radius:12px;text-align:center;margin:15px 0;font-weight:600}
    .success{background:#d1fae5;color:#065f46;border:2px solid #a7f3d0}
    .error{background:#fee2e2;color:#991b1b;border:2px solid #fca5a5}
    #loginContainer{display:block}
    #appContainer{display:none}
    .form-row{display:flex;gap:12px}
    .form-row input{flex:1}
    .status-buttons,.session-buttons{display:flex;gap:10px;flex-wrap:wrap;margin:10px 0}
    .status-btn,.session-btn{flex:1;padding:12px;border:2px solid #e5e7eb;border-radius:10px;font-weight:600;cursor:pointer;transition:all 0.2s;min-width:80px}
    .status-btn.active,.session-btn.active{border-color:#3b82f6;background:#3b82f6;color:white;transform:scale(0.98)}
    .status-present{background:#dcfce7;border-color:#22c55e;color:#166534}
    .status-absent{background:#fee2e2;border-color:#ef4444;color:#dc2626}
    .status-late{background:#fef3c7;border-color:#f59e0b;color:#d97706}
    .status-sick{background:#e0e7ff;border-color:#6366f1;color:#3730a3}
    .students-list{max-height:350px;overflow-y:auto;margin:20px 0}
    .student-row{display:flex;justify-content:space-between;align-items:center;padding:15px;background:#f8fafc;border-radius:12px;margin:8px 0;border-left:4px solid #3b82f6}
    .student-info{font-weight:600}
    .user-section{background:#f8fafc;padding:20px;border-radius:12px;margin:20px 0}
    .user-row{display:flex;justify-content:space-between;align-items:center;padding:12px;background:white;border-radius:8px;margin:8px 0;border-left:3px solid #10b981}
    
    /* Statistics Cards */
    .stats-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;margin:20px 0}
    .stat-card{background:linear-gradient(135deg,#f3f4f6,#e5e7eb);border-radius:12px;padding:20px;text-align:center;box-shadow:0 4px 6px rgba(0,0,0,0.1);border-left:4px solid #3b82f6}
    .stat-card.active{background:linear-gradient(135deg,#dcfce7,#a7f3d0);border-left-color:#22c55e}
    .stat-card.inactive{background:linear-gradient(135deg,#fef3c7,#fde68a);border-left-color:#f59e0b}
    .stat-card.dropout{background:linear-gradient(135deg,#fee2e2,#fecaca);border-left-color:#ef4444}
    .stat-number{font-size:32px;font-weight:800;margin:10px 0;color:#1e293b}
    .stat-label{font-size:14px;color:#6b7280;font-weight:600}
    
    /* Chart Container */
    .chart-container{background:#f8fafc;border-radius:12px;padding:20px;margin:20px 0;text-align:center}
    .chart-placeholder{width:100%;height:200px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);border-radius:12px;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:18px}
    
    /* User Management Styles */
    .user-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:15px;margin:20px 0}
    .user-card{background:white;border-radius:12px;padding:15px;border:2px solid #e5e7eb;box-shadow:0 2px 4px rgba(0,0,0,0.05);transition:all 0.3s}
    .user-card:hover{transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.1);border-color:#3b82f6}
    .user-role{display:inline-block;padding:4px 10px;border-radius:20px;font-size:12px;font-weight:600;margin-top:5px}
    .role-admin{background:#fee2e2;color:#dc2626}
    .role-teacher{background:#dbeafe;color:#1e40af}
    .role-student{background:#dcfce7;color:#166534}
    .user-actions{display:flex;gap:8px;margin-top:10px}
    .user-btn{flex:1;padding:8px;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;border:none;transition:all 0.2s}
    .btn-edit{background:#dbeafe;color:#1e40af}
    .btn-delete{background:#fee2e2;color:#dc2626}
    .btn-activate{background:#dcfce7;color:#166534}
    
    /* Toggle Switch */
    .toggle-switch{position:relative;display:inline-block;width:50px;height:24px;margin:5px 0}
    .toggle-switch input{opacity:0;width:0;height:0}
    .slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#e5e7eb;transition:.4s;border-radius:24px}
    .slider:before{position:absolute;content:"";height:18px;width:18px;left:3px;bottom:3px;background-color:white;transition:.4s;border-radius:50%}
    input:checked + .slider{background-color:#22c55e}
    input:checked + .slider:before{transform:translateX(26px)}
  </style>
</head>
<body>
  <!-- LOGIN -->
  <div class="container" id="loginContainer">
    <div class="card">
      <h1>üè´ Sool Primary School</h1>
      <form id="loginForm">
        <label>üë§ Username</label>
        <input type="text" id="username" placeholder="A, M, S, I, Z, AHMED" required>
        <label>üîë Password</label>
        <input type="password" id="password" placeholder="Enter password" required>
        <button type="submit" class="btn btn-primary">Login ‚Üí</button>
        <div id="loginMessage" class="message" style="display:none"></div>
      </form>
      
      <div style="background:#f0f9ff;padding:20px;border-radius:12px;margin-top:25px;font-size:14px">
        <strong>üìã Test Credentials:</strong>
        <div style="margin-top:10px">
          <strong>Teachers:</strong> A/3245 | M/5467 | S/7689 | I/8789 | Z/9890<br>
          <strong>Admin:</strong> AHMED/6884433@@
        </div>
      </div>
    </div>
  </div>

  <!-- MAIN APP -->
  <div class="container" id="appContainer">
    <div class="card">
      <div style="text-align:center;padding:15px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:white;border-radius:12px 12px 0 0;margin:-30px -30px 20px -30px">
        <h1>üìö School Dashboard</h1>
        <div id="userInfo"></div>
      </div>

      <div class="tabs" id="tabs"></div>
      <div id="globalMessage" class="message" style="display:none"></div>

      <!-- ATTENDANCE TAB -->
      <div id="attendanceTab" class="tab-content active">
        <label>Date:</label>
        <div class="form-row">
          <input type="date" id="attDate">
          <button type="button" class="btn btn-success" onclick="setToday()" style="width:120px;padding:15px 10px">Today</button>
        </div>
        
        <label>Session:</label>
        <div class="session-buttons">
          <button class="session-btn active" data-session="morning">Morning</button>
          <button class="session-btn" data-session="afternoon">Afternoon</button>
        </div>
        
        <label>Class:</label>
        <select id="attClass">
          <option value="">Select Class</option>
          <option value="1aad">Grade 1 - 1aad</option>
          <option value="2aad">Grade 2 - 2aad</option>
          <option value="3aad">Grade 3 - 3aad</option>
          <option value="4aad">Grade 4 - 4aad</option>
          <option value="5aad">Grade 5 - 5aad</option>
          <option value="6aad">Grade 6 - 6aad</option>
          <option value="7aad">Grade 7 - 7aad</option>
          <option value="8aad">Grade 8 - 8aad</option>
        </select>

        <button class="btn btn-success" onclick="markAllPresent()" style="margin:20px 0">üìã Mark All Present</button>

        <h3>Single Entry:</h3>
        <label>Roll Number:</label>
        <input type="number" id="attRoll" placeholder="Enter roll number" min="1">
        <label>Student Name:</label>
        <input type="text" id="attName" placeholder="Will auto-fill">
        
        <label>Status:</label>
        <div class="status-buttons">
          <button class="status-btn present active" data-status="present">Present</button>
          <button class="status-btn absent" data-status="absent">Absent</button>
          <button class="status-btn late" data-status="late">Late</button>
          <button class="status-btn sick" data-status="sick">Sick</button>
        </div>
        <button class="btn btn-primary" onclick="saveAttendance()">üíæ Save Attendance</button>

        <div id="attendanceList" class="students-list" style="display:none"></div>
        <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
      </div>

      <!-- STUDENT REGISTRATION (ADMIN ONLY) -->
      <div id="registerTab" class="tab-content">
        <h2>üìù Student Registration</h2>
        <label>Full Name:</label><input type="text" id="regName">
        <label>Mother's Name:</label><input type="text" id="regMother">
        <label>Date of Birth:</label><input type="date" id="regDob">
        <label>Place of Birth:</label><input type="text" id="regPob" placeholder="e.g. Garowe">
        <label>Contact Number:</label><input type="tel" id="regPhone" placeholder="+252 61...">
        <label>Class:</label>
        <select id="regClass">
          <option value="">Select Class</option>
          <option value="1aad">Grade 1 - 1aad</option>
          <option value="2aad">Grade 2 - 2aad</option>
          <option value="3aad">Grade 3 - 3aad</option>
          <option value="4aad">Grade 4 - 4aad</option>
          <option value="5aad">Grade 5 - 5aad</option>
          <option value="6aad">Grade 6 - 6aad</option>
          <option value="7aad">Grade 7 - 7aad</option>
          <option value="8aad">Grade 8 - 8aad</option>
        </select>
        <button class="btn btn-primary" onclick="registerStudent()">‚ûï Register Student</button>
        <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
      </div>

      <!-- STUDENT STATISTICS TAB -->
      <div id="statsTab" class="tab-content">
        <h2>üìä Student Statistics</h2>
        
        <div class="stats-container">
          <div class="stat-card active">
            <div class="stat-label">Active Students</div>
            <div class="stat-number" id="activeCount">0</div>
          </div>
          <div class="stat-card inactive">
            <div class="stat-label">Inactive Students</div>
            <div class="stat-number" id="inactiveCount">0</div>
          </div>
          <div class="stat-card dropout">
            <div class="stat-label">Dropout Students</div>
            <div class="stat-number" id="dropoutCount">0</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Total Students</div>
            <div class="stat-number" id="totalCount">0</div>
          </div>
        </div>
        
        <div class="chart-container">
          <h3 style="margin-bottom:15px;color:#1e293b">Student Status Distribution</h3>
          <div class="chart-placeholder" id="statsChart">
            Student Status Chart
          </div>
        </div>
        
        <div style="background:#f8fafc;padding:20px;border-radius:12px;margin:20px 0">
          <h3 style="margin-bottom:15px;color:#1e293b">üìä Detailed Breakdown</h3>
          <div style="display:flex;justify-content:space-between;margin:10px 0">
            <span style="font-weight:600">Active:</span>
            <span id="activeDetail">0 students</span>
          </div>
          <div style="display:flex;justify-content:space-between;margin:10px 0">
            <span style="font-weight:600">Inactive:</span>
            <span id="inactiveDetail">0 students</span>
          </div>
          <div style="display:flex;justify-content:space-between;margin:10px 0">
            <span style="font-weight:600">Dropout:</span>
            <span id="dropoutDetail">0 students</span>
          </div>
          <div style="display:flex;justify-content:space-between;margin:10px 0;border-top:2px solid #e5e7eb;padding-top:10px">
            <span style="font-weight:700">Total:</span>
            <span style="font-weight:700" id="totalDetail">0 students</span>
          </div>
        </div>
        
        <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
      </div>

      <!-- USER MANAGEMENT TAB (ADMIN ONLY) -->
      <div id="usersTab" class="tab-content">
        <h2>üë• User Management</h2>
        
        <div style="background:#f0f9ff;padding:15px;border-radius:12px;margin-bottom:20px">
          <h3 style="margin-bottom:10px;color:#1e40af">‚ûï Add New User</h3>
          <label>Username:</label>
          <input type="text" id="newUsername" placeholder="Enter username">
          <label>Password:</label>
          <input type="password" id="newPassword" placeholder="Enter password">
          <label>Role:</label>
          <select id="newUserRole">
            <option value="teacher">Teacher</option>
            <option value="admin">Admin</option>
            <option value="student">Student</option>
          </select>
          <button class="btn btn-success" onclick="addNewUser()" style="margin-top:10px">‚ûï Create User</button>
        </div>
        
        <h3 style="margin:25px 0 15px 0;color:#1e293b">üìã All Users</h3>
        <div class="user-grid" id="usersList">
          <!-- Users will be populated here -->
        </div>
        
        <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
      </div>

      <!-- FEE MANAGEMENT (ADMIN ONLY) -->
      <div id="feeTab" class="tab-content">
        <h2>üí∞ Fee Management</h2>
        <label>Student Name:</label><input type="text" id="feeStudent">
        <label>Roll Number:</label><input type="text" id="feeRoll">
        <label>Class:</label>
        <select id="feeClass">
          <option value="">Select Class</option>
          <option value="1aad">Grade 1 - 1aad</option>
          <option value="2aad">Grade 2 - 2aad</option>
          <option value="3aad">Grade 3 - 3aad</option>
          <option value="4aad">Grade 4 - 4aad</option>
          <option value="5aad">Grade 5 - 5aad</option>
          <option value="6aad">Grade 6 - 6aad</option>
          <option value="7aad">Grade 7 - 7aad</option>
          <option value="8aad">Grade 8 - 8aad</option>
        </select>
        <label>Amount:</label>
        <input type="number" id="feeAmount" placeholder="Enter amount">
        <button class="btn btn-primary" onclick="processFee()">‚úÖ Process Payment</button>
        <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
      </div>
    </div>
  </div>

  <script>
    // Sample data for demonstration
    let students = [
      { id: 1, name: "Ahmed Ali", class: "1aad", status: "active" },
      { id: 2, name: "Fatima Hassan", class: "2aad", status: "active" },
      { id: 3, name: "Mohamed Yusuf", class: "3aad", status: "inactive" },
      { id: 4, name: "Aisha Ibrahim", class: "1aad", status: "active" },
      { id: 5, name: "Omar Farah", class: "4aad", status: "dropout" },
      { id: 6, name: "Safia Ahmed", class: "2aad", status: "active" },
      { id: 7, name: "Ibrahim Hassan", class: "5aad", status: "active" },
      { id: 8, name: "Layla Mohamed", class: "3aad", status: "inactive" },
      { id: 9, name: "Yusuf Ali", class: "6aad", status: "active" },
      { id: 10, name: "Hodan Farah", class: "1aad", status: "dropout" }
    ];

    let users = [
      { id: 1, username: "AHMED", role: "admin", active: true },
      { id: 2, username: "A", role: "teacher", active: true },
      { id: 3, username: "M", role: "teacher", active: true },
      { id: 4, username: "S", role: "teacher", active: true },
      { id: 5, username: "I", role: "teacher", active: true },
      { id: 6, username: "Z", role: "teacher", active: true }
    ];

    let currentUser = null;

    // Initialize today's date
    function setToday() {
      document.getElementById('attDate').valueAsDate = new Date();
    }
    setToday();

    // Session button handlers
    document.querySelectorAll('.session-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.session-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    // Status button handlers
    document.querySelectorAll('.status-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.status-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
    });

    // LOGIN HANDLER
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const username = document.getElementById('username').value.trim().toUpperCase();
      const password = document.getElementById('password').value.trim();
      const msg = document.getElementById('loginMessage');
      
      // Valid credentials per spec
      const TEACHERS = { 'A':'3245','M':'5467','S':'7689','I':'8789','Z':'9890' };
      const ADMIN = { 'AHMED':'6884433@@' };
      
      let userType = '';
      
      // Validate credentials
      if (ADMIN[username] && ADMIN[username] === password) {
        userType = 'Admin';
        currentUser = { username, role: 'admin' };
      } else if (TEACHERS[username] && TEACHERS[username] === password) {
        userType = 'Teacher';
        currentUser = { username, role: 'teacher' };
      }
      
      if (userType) {
        // Successful login
        document.getElementById('userInfo').textContent = `${userType}: ${username}`;
        document.getElementById('loginContainer').style.display = 'none';
        document.getElementById('appContainer').style.display = 'block';
        msg.style.display = 'none';
        
        // Initialize tabs
        initTabs(userType);
        
        // Load statistics
        loadStudentStatistics();
        
        // Load users (admin only)
        if (userType === 'Admin') {
          loadUsers();
        }
      } else {
        // Failed login
        msg.textContent = '‚ùå Invalid credentials! Check test credentials below.';
        msg.className = 'message error';
        msg.style.display = 'block';
      }
    });

    // Initialize tabs based on user role
    function initTabs(userType) {
      const tabsContainer = document.getElementById('tabs');
      tabsContainer.innerHTML = '';
      
      // Common tabs
      addTab('attendanceTab', 'üìÖ Attendance', true);
      
      if (userType === 'Admin') {
        addTab('registerTab', 'üìù Register');
        addTab('statsTab', 'üìä Statistics');
        addTab('usersTab', 'üë• Users');
        addTab('feeTab', 'üí∞ Fees');
      }
      
      // Set up tab click handlers
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const targetTab = btn.dataset.tab;
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
          btn.classList.add('active');
          document.getElementById(targetTab).classList.add('active');
        });
      });
    }

    function addTab(tabId, label, isActive = false) {
      const tabsContainer = document.getElementById('tabs');
      const tabBtn = document.createElement('button');
      tabBtn.className = `tab-btn ${isActive ? 'active' : ''}`;
      tabBtn.textContent = label;
      tabBtn.dataset.tab = tabId;
      tabsContainer.appendChild(tabBtn);
      
      if (isActive) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
      }
    }

    // Load student statistics
    function loadStudentStatistics() {
      const active = students.filter(s => s.status === 'active').length;
      const inactive = students.filter(s => s.status === 'inactive').length;
      const dropout = students.filter(s => s.status === 'dropout').length;
      const total = students.length;
      
      document.getElementById('activeCount').textContent = active;
      document.getElementById('inactiveCount').textContent = inactive;
      document.getElementById('dropoutCount').textContent = dropout;
      document.getElementById('totalCount').textContent = total;
      
      document.getElementById('activeDetail').textContent = `${active} students`;
      document.getElementById('inactiveDetail').textContent = `${inactive} students`;
      document.getElementById('dropoutDetail').textContent = `${dropout} students`;
      document.getElementById('totalDetail').textContent = `${total} students`;
      
      // Update chart placeholder with percentages
      const activePct = ((active / total) * 100).toFixed(1);
      const inactivePct = ((inactive / total) * 100).toFixed(1);
      const dropoutPct = ((dropout / total) * 100).toFixed(1);
      
      document.getElementById('statsChart').innerHTML = `
        <div style="text-align:left">
          <div style="margin:10px 0">
            <span style="display:inline-block;width:100px;font-weight:600">Active:</span>
            <div style="background:#22c55e;width:${activePct}%;height:20px;border-radius:10px;display:inline-block"></div>
            <span style="margin-left:10px">${activePct}%</span>
          </div>
          <div style="margin:10px 0">
            <span style="display:inline-block;width:100px;font-weight:600">Inactive:</span>
            <div style="background:#f59e0b;width:${inactivePct}%;height:20px;border-radius:10px;display:inline-block"></div>
            <span style="margin-left:10px">${inactivePct}%</span>
          </div>
          <div style="margin:10px 0">
            <span style="display:inline-block;width:100px;font-weight:600">Dropout:</span>
            <div style="background:#ef4444;width:${dropoutPct}%;height:20px;border-radius:10px;display:inline-block"></div>
            <span style="margin-left:10px">${dropoutPct}%</span>
          </div>
        </div>
      `;
    }

    // Load users list
    function loadUsers() {
      const usersList = document.getElementById('usersList');
      usersList.innerHTML = '';
      
      users.forEach(user => {
        const userCard = document.createElement('div');
        userCard.className = 'user-card';
        userCard.innerHTML = `
          <div style="font-weight:700;font-size:16px">${user.username}</div>
          <div class="user-role role-${user.role}">${user.role.charAt(0).toUpperCase() + user.role.slice(1)}</div>
          <div style="font-size:12px;color:#6b7280;margin-top:5px">
            Status: ${user.active ? '‚úÖ Active' : '‚ùå Inactive'}
          </div>
          <div class="user-actions">
            <button class="user-btn btn-edit" onclick="editUser(${user.id})">‚úèÔ∏è Edit</button>
            <button class="user-btn btn-${user.active ? 'delete' : 'activate'}" onclick="toggleUserStatus(${user.id})">
              ${user.active ? '‚ùå Deactivate' : '‚úÖ Activate'}
            </button>
          </div>
        `;
        usersList.appendChild(userCard);
      });
    }

    // Add new user
    function addNewUser() {
      const username = document.getElementById('newUsername').value.trim().toUpperCase();
      const password = document.getElementById('newPassword').value.trim();
      const role = document.getElementById('newUserRole').value;
      
      if (!username || !password) {
        showMessage('Please fill in all fields', 'error');
        return;
      }
      
      // Check if username already exists
      if (users.some(u => u.username === username)) {
        showMessage('Username already exists!', 'error');
        return;
      }
      
      const newUser = {
        id: users.length + 1,
        username: username,
        role: role,
        active: true
      };
      
      users.push(newUser);
      loadUsers();
      
      // Clear form
      document.getElementById('newUsername').value = '';
      document.getElementById('newPassword').value = '';
      
      showMessage('User created successfully!', 'success');
    }

    // Toggle user status
    function toggleUserStatus(userId) {
      const user = users.find(u => u.id === userId);
      if (user) {
        user.active = !user.active;
        loadUsers();
        showMessage(`User ${user.active ? 'activated' : 'deactivated'} successfully!`, 'success');
      }
    }

    // Edit user (placeholder)
    function editUser(userId) {
      const user = users.find(u => u.id === userId);
      if (user) {
        alert(`Edit user: ${user.username}\nRole: ${user.role}\nStatus: ${user.active ? 'Active' : 'Inactive'}`);
      }
    }

    // Show message helper
    function showMessage(text, type) {
      const msg = document.getElementById('globalMessage');
      msg.textContent = text;
      msg.className = `message ${type}`;
      msg.style.display = 'block';
      
      setTimeout(() => {
        msg.style.display = 'none';
      }, 3000);
    }

    // LOGOUT FUNCTION
    window.logout = function() {
      document.getElementById('loginContainer').style.display = 'block';
      document.getElementById('appContainer').style.display = 'none';
      document.getElementById('loginForm').reset();
      document.getElementById('loginMessage').style.display = 'none';
      currentUser = null;
    };

    // STUBS TO PREVENT CONSOLE ERRORS
    window.markAllPresent = () => showMessage('‚úÖ All students marked present for this session!', 'success');
    window.saveAttendance = () => showMessage('üíæ Attendance saved successfully!', 'success');
    window.registerStudent = () => {
      showMessage('‚ûï Student registered successfully!', 'success');
      // Add to students array
      const name = document.getElementById('regName').value || 'New Student';
      students.push({
        id: students.length + 1,
        name: name,
        class: document.getElementById('regClass').value || '1aad',
        status: 'active'
      });
      loadStudentStatistics();
    };
    window.processFee = () => showMessage('‚úÖ Fee payment processed!', 'success');
  </script>
</body>
</html>
